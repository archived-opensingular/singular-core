(function(a){if(typeof(Wicket)==="undefined"){window.Wicket={}}Wicket.WUPB=Wicket.Class.create();Wicket.WUPB.prototype={initialize:function(g,f,d,b,h,e){this.statusid=f;this.barid=d;this.url=b;this.fileid=h;this.initialStatus=e;var c=Wicket.$(g);this.originalCallback=c.onsubmit;c.onsubmit=Wicket.bind(this.submitCallback,this)},submitCallback:function(){if(this.originalCallback&&!this.originalCallback()){return false}else{this.start();return true}},start:function(){var c=true;if(this.fileid){var b=Wicket.$(this.fileid);c=b&&b.value}if(c){this.setPercent(0);this.setStatus(this.initialStatus);Wicket.DOM.show(this.statusid,"block");Wicket.DOM.show(this.barid,"block");this.scheduleUpdate()}},setStatus:function(b){var c=document.createElement("label");c.innerHTML=b;var d=Wicket.$(this.statusid).firstChild;if(d!=null){Wicket.$(this.statusid).removeChild(d)}Wicket.$(this.statusid).appendChild(c)},setPercent:function(b){Wicket.$(this.barid).firstChild.firstChild.style.width=b+"%"},scheduleUpdate:function(){window.setTimeout(Wicket.bind(this.load,this),1000)},_createIFrame:function(c){var b=jQuery('<iframe name="'+c+'" id="'+c+'" src="about:blank" style="position: absolute; top: -9999px; left: -9999px;">');return b[0]},load:function(){var b=this.url;this.iframe=this._createIFrame(""+Math.random());document.body.appendChild(this.iframe);Wicket.Event.add(this.iframe,"load",Wicket.bind(this.update,this));this.iframe.src=b},update:function(){var d;if(this.iframe.contentDocument){d=this.iframe.contentDocument.body.innerHTML}else{d=this.iframe.contentWindow.document.body.innerHTML}var e=d.split("|");var c=e[1];var b=e[2];this.setPercent(c);this.setStatus(b);this.iframe.parentNode.removeChild(this.iframe);this.iframe=null;if(c==="100"){Wicket.DOM.hide(this.statusid);Wicket.DOM.hide(this.barid)}else{this.scheduleUpdate()}}}})();